<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>GrapesJS Plugin</title>
    <script src="node_modules/grapesjs/dist/grapes.min.js"></script>
    <link href="node_modules/grapesjs/dist/css/grapes.min.css" rel="stylesheet">
    
    <script src="dist/grapesjs-mjml.min.js"></script>
    <style>
      body, html{ height: 100%; margin: 0;}
      .cke_top {
        background: #444 !important;
      }
      .cke_chrome {
        border: none !important;
      }
      .cke_toolgroup {
        border: none !important;
        background: transparent !important;
        box-shadow: none !important;
      }
    </style>
  </head>
  <body>

    <div id="gjs" style="height:0px; overflow:hidden">
      <mjml>
        <mj-body>
          <mj-container>

              <!-- Company Header -->
              <mj-section background-color="#f0f0f0">
                <mj-column>
                  <mj-text font-style="italic" font-size="20" color="#626262">
                    My Company
                  </mj-text>
                </mj-column>
              </mj-section>

          </mj-container>
        </mj-body>
      </mjml>
    </div>


    <script type="text/javascript">
      console.log(grapesjs);
      /*
      var editor = grapesjs.init({
        height: '100%',
        noticeOnUnload: 0,
        storageManager:{autoload: 0},
        container : '#gjs',
        fromElement: true,

        plugins: ['gjs-mjml'],
        pluginsOpts: {
          'gjs-mjml': {
          }
        }
      });
      */
      //mj-container mj-section mj-column mj-text mj-image mj-button mj-social mj-divider mj-spacer
      
      var editor = grapesjs.init({
          container : '#gjs',
          height: '100%',
          storageManager: {type: 'none'},
          components: '<div style="width:300px; min-height:100px; margin: 0 auto"></div>' +
              '<div style="width:400px; min-height:100px; margin: 0 auto"></div>' +
              '<div style="width:500px; min-height:100px; margin: 0 auto"></div>',
          panels: {
            defaults  : [{
              id      : 'commands',
              buttons : [{
                  id          : 'mainLogo',
                  className   : '',
                  attributes  : {
                    title: 'main-logo',
                    style: 'background: url("/src/images/main-logo.png");background-size:cover;width: 33px;'
                  },
                  command     : 'myCommand'
              },{
                id          : 'smile',
                className   : 'fa fa-smile-o',
                attributes  : { title: 'Smile' },
                command     : 'helloWorld'
              },{
                id        : 'vis',
                className : 'fa fa-eye',
                command   : 'sw-visibility',
                context   : 'some-random-context', // For grouping context of buttons in the same panel
                active    : true
              }]
            }]
          },
          commands : {
            defaults: [{
              id: 'helloWorld',
              run:  function(editor, sender){
                console.log('run!!!');
                alert('run?!');
              },
              stop:  function(editor, sender){
                console.log('Stop!!!');
                alert('Stop!');
              },
            }]
          }
      });
      var commands = editor.Commands;
      commands.add('myCommand', {
        run:  function(editor, sender){
          alert('Hello world!');
        },
        stop:  function(editor, sender){
        },
      });
      var domComponents = editor.DomComponents;
      /*
      var comp1 = domComponents.addComponent({
        tagName: 'div',
        removable: true, // Can't remove it
        draggable: true, // Can't move it
        copyable: true, // Disable copy/past
        content: 'Content text', // Text inside component
        style: { color: 'red'},
        attributes: { title: 'here' }
      });
      */
      console.log(domComponents);
      /*
      var testFn = commands.get('helloWorld');
      testFn.run();
      console.log(testFn);
      console.log(commands);
      */
      window.editor = editor;
    </script>
  </body>
</html>
